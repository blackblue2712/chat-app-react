{"ast":null,"code":"var _jsxFileName = \"/opt/lampp/htdocs/STUDY_SPACE/chat-app/src/chats/ChatServerArea.js\";\nimport React from 'react';\nimport ItemMessage from '../chats/ItemMessage';\nimport YouTubePlayer from 'youtube-player';\nimport socketIOClient from 'socket.io-client';\nimport Template from '../component/TemplateWithNavigationForChanel';\nimport \"./chatServerArea.css\";\nimport { getSingleChanel, getChanelMessages, postSaveChanelMessage, searchYoutube } from \"../controllers/ChanelController\";\n\nconst moment = require(\"moment\");\n\nclass ChatServerArea extends React.Component {\n  constructor() {\n    super();\n\n    this.getSingleChanel = () => {\n      if (this.chanelId !== \"anonymous\") {\n        getSingleChanel(this.chanelId).then(res => {\n          if (!res.message) {\n            this.setState({\n              chanel: res\n            });\n          }\n        });\n      } else {\n        this.setState({\n          chanel: {\n            chanelName: \"Anonymus chanel\"\n          }\n        });\n      }\n    };\n\n    this.getChanelMessages = cb => {\n      let token = this.props.userPayload.token;\n      getChanelMessages({\n        cid: this.chanelId,\n        limit: this.LIMIT_MESSAGES,\n        skip: this.SKIP_MESSAGES\n      }, token).then(res => {\n        console.log(\"getChanelMessages\", res);\n\n        if (res.length > 0) {\n          this.setState({\n            messageList: res.concat(this.state.messageList)\n          });\n          cb();\n          this.SKIP_MESSAGES += this.LIMIT_MESSAGES;\n        }\n      }).catch(err => console.log(err));\n    };\n\n    this.onScrollGetMoreMessages = event => {\n      try {\n        let container = document.querySelector(\"#chat-area .content .container\");\n\n        if (container.scrollTop === 0) {\n          this.getChanelMessages(() => {\n            setTimeout(this.scrollToTop, 0);\n          });\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    };\n\n    this.scrollToBottom = () => {\n      try {\n        document.querySelector(\"#end-of-message\").scrollIntoView({\n          behavior: \"smooth\"\n        });\n      } catch (e) {}\n    };\n\n    this.scrollToTop = () => {\n      try {\n        document.querySelector(\"#start-of-message\").scrollIntoView({\n          behavior: \"smooth\"\n        });\n      } catch (e) {}\n    };\n\n    this.handleCreateConnectSocket = () => {\n      this.socket = socketIOClient(process.env.REACT_APP_API_URL, {\n        transports: ['websocket']\n      }); // wait client connect\n\n      this.socket.on('connect', () => {\n        let sid = this.socket.id;\n        let uid = this.props.userPayload.user._id;\n        let name = this.props.userPayload.user.fullname || this.props.userPayload.user.email;\n        let photo = this.props.userPayload.user.photo;\n        this.socket.emit(\"join-chanel\", {\n          sid,\n          uid,\n          name,\n          photo,\n          chanelId: this.chanelId\n        }, () => {\n          console.log(\"User has join this chanel\", this.chanelId);\n        });\n        this.socket.on(\"server-send-message-from-chanel\", res => {\n          // console.log(\"server-send-message-from-chanel\", sid, res.data);\n          if (this.chanelId === \"anonymous\") res.data.sender.photo = \"https://res.cloudinary.com/ddrw0yq95/image/upload/v1581392392/kjadclbvhq0gjnwvihnp.png\";\n          if (uid === res.data.sender._id) res.data.isMe = \"me\";\n          this.setState({\n            messageList: this.state.messageList.concat(res.data)\n          });\n        });\n        this.socket.on(\"server-send-message-contain-image-from-chanel\", res => {\n          console.log(\"server-send-message-contain-image-from-chanel\", sid, res.data);\n\n          if (uid !== res.data.sender._id) {\n            this.setState({\n              messageList: this.state.messageList.concat(res.data)\n            });\n          }\n        });\n        this.socket.on(\"list-connected-chanel-users\", users => {\n          this.setState({\n            onlineUsers: users\n          });\n        });\n      });\n    };\n\n    this.handleSendMessageFromChanel = () => {\n      try {\n        window.event.preventDefault();\n        let {\n          chanelId\n        } = this.props.match.params;\n        let textMessage = document.getElementById(\"text-message\");\n\n        if (textMessage.value.trim() || this.formData.get(\"photo\")) {\n          document.querySelector(\".preview-image #preview\").src = \"\";\n          document.querySelector(\".preview-image\").classList.remove(\"on\");\n          let uid = this.props.userPayload.user._id;\n          let name = this.props.userPayload.user.fullname || this.props.userPayload.user.email;\n          let photo = this.props.userPayload.user.photo;\n          let token = this.props.userPayload.token; // emit event\n\n          let data = {};\n          data.sender = {};\n          data.chanelId = chanelId;\n          data.content = textMessage.value;\n          data.sender._id = uid;\n          data.sender.photo = photo;\n          data.sender.name = name;\n          this.socket.emit(\"client-send-message-from-chanel\", data, () => {\n            textMessage.value = \"\";\n            document.querySelector(\"#chat-area .content .container\").scrollBy(0, 2000);\n          });\n\n          if (chanelId !== \"anonymous\") {\n            this.formData.append(\"cid\", chanelId);\n            this.formData.append(\"uid\", uid);\n            this.formData.append(\"content\", textMessage.value);\n            postSaveChanelMessage(this.formData, token).then(res => {\n              console.log(res);\n              this.formData.delete(\"photo\");\n\n              if (res && res.urlContainImage) {\n                let dataImage = {\n                  sender: {\n                    _id: uid,\n                    name,\n                    photo: photo\n                  },\n                  photo: res.urlContainImage\n                };\n                this.setState({\n                  messageList: this.state.messageList.concat(dataImage)\n                });\n                dataImage.chanelId = chanelId;\n                this.socket.emit(\"client-send-message-contain-image-from-chanel\", dataImage, () => {\n                  console.log(\"Server-send-message-contain-image-from-chanel\");\n                });\n              }\n            }).catch(err => {\n              console.log(err);\n            });\n          } else {\n            if (data.content.indexOf(\">p\") !== -1) {\n              this.player = YouTubePlayer('video-player');\n              this.handleSearchYoutuebe(data.content, this.player);\n            }\n          }\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    this.handleSearchYoutuebe = q => {\n      searchYoutube(q).then(res => {\n        console.log(this.player);\n        var vid = res.videoId;\n\n        if (vid) {\n          this.onPlaying.push(vid);\n        }\n\n        this.player.loadVideoById(vid);\n        this.player.playVideo();\n        this.player.on('stateChange', event => {\n          console.log(\"stateChange\", event);\n\n          if (event.data === 0) {\n            console.log(\"end of video\", this.onPlaying);\n            this.player.destroy();\n            setTimeout(() => {\n              this.player.loadVideoById(this.onPlaying.shift);\n              this.player.playVideo();\n            }, 0);\n          }\n        });\n      });\n    };\n\n    this.handlePasteToInput = event => {\n      try {\n        let items = (event.clipboardData || event.originalEvent.clipboardData).items; // find pasted image among pasted items\n\n        let blob = null;\n\n        for (let i = 0; i < items.length; i++) {\n          if (items[i].type.indexOf(\"image\") === 0) {\n            blob = items[i].getAsFile();\n          }\n        } // load image if there is a pasted image\n\n\n        if (blob !== null) {\n          let reader = new FileReader();\n\n          reader.onload = function (event) {\n            document.querySelector('.preview-image').classList.add(\"on\");\n            document.querySelector(\".preview-image #preview\").src = this.result;\n          };\n\n          reader.readAsDataURL(blob);\n          this.formData.append(\"photo\", blob);\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    this.clearFormDataImage = () => {\n      document.querySelector('.preview-image').classList.remove(\"on\");\n      document.querySelector('.preview-image #preview').src = \"\";\n      this.formData.delete(\"photo\");\n    };\n\n    this.previewPhoto = event => {\n      let reader = new FileReader();\n      document.querySelector('.preview-image').classList.add(\"on\");\n      let inputAvatar = document.querySelector('.preview-image #preview');\n\n      reader.onload = function () {\n        inputAvatar.src = reader.result;\n      };\n\n      try {\n        reader.readAsDataURL(event.target.files[0]);\n        this.formData.append(\"photo\", event.target.files[0]);\n      } catch (e) {// do nothing\n      }\n    };\n\n    this.checkUserEnter = e => {\n      if (e.keyCode === 13) {\n        this.handleSendMessageFromChanel();\n      }\n    };\n\n    this.toggleDropdown = () => {\n      try {\n        let drdElement = document.querySelector(\"#chat-area .list-more\");\n\n        if (drdElement.classList.length > 2) {\n          drdElement.classList.remove(\"active\");\n        } else {\n          drdElement.classList.add(\"active\");\n          document.getElementById(\"root\").addEventListener(\"click\", () => {\n            drdElement.classList.remove(\"active\");\n          });\n        }\n      } catch (e) {}\n    };\n\n    this.state = {\n      messageList: [],\n      onlineUsers: [],\n      chanel: {}\n    };\n    this.formData = new FormData();\n    this.LIMIT_MESSAGES = 10;\n    this.SKIP_MESSAGES = 0;\n    this.onPlaying = [];\n  }\n\n  componentDidMount() {\n    try {\n      this.chanelId = this.props.match.params.chanelId; // Scroll content message to bottom\n\n      window.onload = () => {\n        this.scrollToBottom();\n        document.querySelector(\"#chat-area .content .container\").addEventListener(\"scroll\", this.onScrollGetMoreMessages);\n      };\n\n      document.getElementById(\"text-message\").addEventListener(\"keyup\", this.checkUserEnter);\n      let {\n        chanelId\n      } = this.props.match.params; // Get chanel info\n\n      this.getSingleChanel();\n      this.getChanelMessages(() => {}); // Socket realtime\n\n      this.handleCreateConnectSocket();\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.chanelId = nextProps.match.params.chanelId;\n    this.SKIP_MESSAGES = 0;\n    let sid = this.socket.id;\n    let uid = this.props.userPayload.user._id;\n    let name = this.props.userPayload.user.fullname || this.props.userPayload.user.email;\n    let photo = this.props.userPayload.user.photo;\n    this.socket.emit(\"join-chanel\", {\n      sid,\n      uid,\n      name,\n      photo,\n      chanelId: this.chanelId\n    }, () => {\n      console.log(\"User has join this chanel\", this.chanelId);\n    });\n    this.setState({\n      messageList: []\n    });\n    this.getSingleChanel();\n    this.getChanelMessages(() => {});\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  render() {\n    let {\n      messageList,\n      onlineUsers,\n      chanel\n    } = this.state;\n    let uid = this.props.userPayload.user._id;\n    let tabActive = document.querySelectorAll(\".item-discussions.active\");\n    Array.from(tabActive).map(el => {\n      el.classList.remove(\"active\");\n    }); // active tab\n\n    let idTabElement = `dcs_${this.chanelId}`;\n    let tabElement = document.getElementById(idTabElement);\n\n    if (tabElement) {\n      tabElement.classList.add(\"active\");\n    }\n\n    return React.createElement(Template, {\n      tabPenel: \"-none\",\n      widthRight: \"calc(100% - 80px)\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"video-player\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      id: \"chat-area\",\n      className: \"chat-server\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"top\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"inside\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"data\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"/chanels\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340\n      },\n      __self: this\n    }, chanel.chanelName))), React.createElement(\"button\", {\n      className: \"btn d-md-block audio-call\",\n      title: \"Audio call\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"ti-headphone-alt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343\n      },\n      __self: this\n    })), React.createElement(\"button\", {\n      className: \"btn d-md-block audio-call\",\n      title: \"Audio call\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 345\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"ti-video-camera\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346\n      },\n      __self: this\n    })), React.createElement(\"button\", {\n      className: \"btn d-md-block audio-call\",\n      title: \"Audio call\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 348\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"ti-info\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"dropdown\",\n      onClick: this.toggleDropdown,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn d-md-block audio-call\",\n      title: \"Audio call\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"ti-gird\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"dropdown-list list-more\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"/\",\n      className: \"voice\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358\n      },\n      __self: this\n    }, \"Voice Call\"), React.createElement(\"a\", {\n      href: \"/\",\n      className: \"voice\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359\n      },\n      __self: this\n    }, \"Video Call\"), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360\n      },\n      __self: this\n    }), React.createElement(\"a\", {\n      href: \"/\",\n      className: \"voice\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361\n      },\n      __self: this\n    }, \"Clear History\"), React.createElement(\"a\", {\n      href: \"/\",\n      className: \"voice\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 362\n      },\n      __self: this\n    }, \"Block Contact\"), React.createElement(\"a\", {\n      href: \"/\",\n      className: \"voice\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363\n      },\n      __self: this\n    }, \"Delete Contact\"))))), React.createElement(\"aside\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 370\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371\n      },\n      __self: this\n    }, messageList.map((item, i) => {\n      if (i === this.LIMIT_MESSAGES - 1) {\n        return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n          id: \"start-of-message\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 376\n          },\n          __self: this\n        }), React.createElement(ItemMessage, {\n          key: i,\n          isMe: item.sender._id === uid ? \"me\" : \"\",\n          content: item.content,\n          contentPhoto: item.photo,\n          photo: item.sender.photo,\n          date: moment(item.created).fromNow() || \"just now\",\n          name: item.sender.fullname || item.sender.email,\n          uid: item.sender._id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 377\n          },\n          __self: this\n        }));\n      }\n\n      return React.createElement(ItemMessage, {\n        key: i,\n        isMe: item.sender._id === uid ? \"me\" : \"\",\n        content: item.content,\n        contentPhoto: item.photo,\n        photo: item.sender.photo,\n        date: moment(item.created).fromNow() || \"just now\",\n        name: item.sender.fullname || item.sender.email,\n        uid: item.sender._id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 390\n        },\n        __self: this\n      });\n    }), React.createElement(\"div\", {\n      id: \"end-of-message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 403\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"scroller\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 405\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"bottom\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 407\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      className: \"text-area\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 408\n      },\n      __self: this\n    }, React.createElement(\"textarea\", {\n      id: \"text-message\",\n      className: \"form-control\",\n      placeholder: \"Start typing for reply...\",\n      rows: 1,\n      defaultValue: \"\",\n      onPaste: this.handlePasteToInput,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 409\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"add-smiles\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 413\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      title: \"add icon\",\n      className: \"em em-blush\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 414\n      },\n      __self: this\n    })), React.createElement(\"button\", {\n      onClick: this.handleSendMessageFromChanel,\n      style: {\n        height: '56x',\n        outline: \"none\"\n      },\n      type: \"submit\",\n      className: \"btn send\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 416\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"ti-location-arrow\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 416\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      className: \"label-input input-file\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 417\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"file\",\n      className: \"d-none\",\n      accept: \"image/*\",\n      onChange: this.previewPhoto,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 418\n      },\n      __self: this\n    }), React.createElement(\"i\", {\n      className: \"ti-clip\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      onClick: this.clearFormDataImage,\n      className: \"preview-image\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      id: \"preview\",\n      src: \"\",\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 428\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"container tab-panel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 431\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"chanel user-online\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 432\n      },\n      __self: this\n    }, React.createElement(\"header\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 433\n      },\n      __self: this\n    }, \"Member online\"), onlineUsers.map((user, i) => {\n      return React.createElement(\"a\", {\n        key: i,\n        href: \"#list-chat\",\n        className: \"item-discussions single\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 436\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"avatar-md\",\n        src: user.photo,\n        alt: \"avt\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 437\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"data\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 438\n        },\n        __self: this\n      }, React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 439\n        },\n        __self: this\n      }, user.name)));\n    }), React.createElement(\"a\", {\n      href: \"#list-chat\",\n      className: \"item-discussions single\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 444\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"avatar-md\",\n      src: \"https://res.cloudinary.com/ddrw0yq95/image/upload/v1581392392/kjadclbvhq0gjnwvihnp.png\",\n      alt: \"avt\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"status offline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 446\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"data\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 447\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 448\n      },\n      __self: this\n    }, \"Bob Frank\"))))))));\n  }\n\n}\n\nexport default ChatServerArea;","map":{"version":3,"sources":["/opt/lampp/htdocs/STUDY_SPACE/chat-app/src/chats/ChatServerArea.js"],"names":["React","ItemMessage","YouTubePlayer","socketIOClient","Template","getSingleChanel","getChanelMessages","postSaveChanelMessage","searchYoutube","moment","require","ChatServerArea","Component","constructor","chanelId","then","res","message","setState","chanel","chanelName","cb","token","props","userPayload","cid","limit","LIMIT_MESSAGES","skip","SKIP_MESSAGES","console","log","length","messageList","concat","state","catch","err","onScrollGetMoreMessages","event","container","document","querySelector","scrollTop","setTimeout","scrollToTop","scrollToBottom","scrollIntoView","behavior","e","handleCreateConnectSocket","socket","process","env","REACT_APP_API_URL","transports","on","sid","id","uid","user","_id","name","fullname","email","photo","emit","data","sender","isMe","users","onlineUsers","handleSendMessageFromChanel","window","preventDefault","match","params","textMessage","getElementById","value","trim","formData","get","src","classList","remove","content","scrollBy","append","delete","urlContainImage","dataImage","indexOf","player","handleSearchYoutuebe","q","vid","videoId","onPlaying","push","loadVideoById","playVideo","destroy","shift","handlePasteToInput","items","clipboardData","originalEvent","blob","i","type","getAsFile","reader","FileReader","onload","add","result","readAsDataURL","clearFormDataImage","previewPhoto","inputAvatar","target","files","checkUserEnter","keyCode","toggleDropdown","drdElement","addEventListener","FormData","componentDidMount","componentWillReceiveProps","nextProps","componentDidUpdate","render","tabActive","querySelectorAll","Array","from","map","el","idTabElement","tabElement","item","created","fromNow","height","outline"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ItemMessage from '../chats/ItemMessage';\nimport YouTubePlayer from 'youtube-player';\nimport socketIOClient from 'socket.io-client';\nimport Template from '../component/TemplateWithNavigationForChanel';\nimport \"./chatServerArea.css\";\n\nimport { getSingleChanel, getChanelMessages, postSaveChanelMessage, searchYoutube } from \"../controllers/ChanelController\";\n\nconst moment = require(\"moment\");\n\nclass ChatServerArea extends React.Component {\n    constructor() {\n        super();\n        this.state = {\n            messageList: [],\n            onlineUsers: [],\n            chanel: {}\n        }\n\n        this.formData = new FormData();\n        this.LIMIT_MESSAGES = 10;\n        this.SKIP_MESSAGES = 0;\n        this.onPlaying = [];\n    }\n\n    componentDidMount() {\n        try {\n            this.chanelId = this.props.match.params.chanelId;\n            // Scroll content message to bottom\n            window.onload = () => {\n                this.scrollToBottom();\n                document.querySelector(\"#chat-area .content .container\").addEventListener(\"scroll\", this.onScrollGetMoreMessages);\n            }\n\n            document.getElementById(\"text-message\").addEventListener(\"keyup\", this.checkUserEnter)\n            let { chanelId } = this.props.match.params;\n            // Get chanel info\n            this.getSingleChanel();\n            this.getChanelMessages(() => { });\n\n            // Socket realtime\n            this.handleCreateConnectSocket();\n\n        } catch (e) { console.log(e) }\n    }\n\n    componentWillReceiveProps(nextProps) {\n        this.chanelId = nextProps.match.params.chanelId;\n        this.SKIP_MESSAGES = 0;\n        let sid = this.socket.id;\n        let uid = this.props.userPayload.user._id;\n        let name = this.props.userPayload.user.fullname || this.props.userPayload.user.email;\n        let photo = this.props.userPayload.user.photo;\n        this.socket.emit(\"join-chanel\", { sid, uid, name, photo, chanelId: this.chanelId }, () => {\n            console.log(\"User has join this chanel\", this.chanelId);\n        })\n        this.setState({ messageList: [] });\n        this.getSingleChanel();\n        this.getChanelMessages(() => { });\n    }\n\n    componentDidUpdate() {\n        this.scrollToBottom();\n    }\n\n    getSingleChanel = () => {\n        if (this.chanelId !== \"anonymous\") {\n            getSingleChanel(this.chanelId)\n                .then(res => {\n                    if (!res.message) {\n                        this.setState({\n                            chanel: res,\n                        });\n                    }\n                });\n        } else {\n            this.setState({\n                chanel: { chanelName: \"Anonymus chanel\" }\n            })\n        }\n    }\n\n    getChanelMessages = (cb) => {\n        let token = this.props.userPayload.token;\n\n        getChanelMessages({ cid: this.chanelId, limit: this.LIMIT_MESSAGES, skip: this.SKIP_MESSAGES }, token)\n            .then(res => {\n                console.log(\"getChanelMessages\", res);\n                if (res.length > 0) {\n                    this.setState({ messageList: res.concat(this.state.messageList) });\n                    cb();\n                    this.SKIP_MESSAGES += this.LIMIT_MESSAGES;\n                }\n            })\n            .catch(err => console.log(err));\n\n    }\n\n    onScrollGetMoreMessages = (event) => {\n        try {\n            let container = document.querySelector(\"#chat-area .content .container\");\n            if (container.scrollTop === 0) {\n                this.getChanelMessages(() => {\n                    setTimeout(this.scrollToTop, 0);\n                });\n            }\n        } catch (err) { console.log(err) }\n    }\n\n    scrollToBottom = () => {\n        try {\n            document.querySelector(\"#end-of-message\").scrollIntoView({ behavior: \"smooth\" });\n        } catch (e) { }\n    }\n\n    scrollToTop = () => {\n        try {\n            document.querySelector(\"#start-of-message\").scrollIntoView({ behavior: \"smooth\" });\n        } catch (e) { }\n    }\n\n    handleCreateConnectSocket = () => {\n        this.socket = socketIOClient(process.env.REACT_APP_API_URL, { transports: ['websocket'] });\n        // wait client connect\n        this.socket.on('connect', () => {\n\n            let sid = this.socket.id;\n            let uid = this.props.userPayload.user._id;\n            let name = this.props.userPayload.user.fullname || this.props.userPayload.user.email;\n            let photo = this.props.userPayload.user.photo;\n\n            this.socket.emit(\"join-chanel\", { sid, uid, name, photo, chanelId: this.chanelId }, () => {\n                console.log(\"User has join this chanel\", this.chanelId);\n            })\n\n            this.socket.on(\"server-send-message-from-chanel\", (res) => {\n                // console.log(\"server-send-message-from-chanel\", sid, res.data);\n                if (this.chanelId === \"anonymous\") res.data.sender.photo = \"https://res.cloudinary.com/ddrw0yq95/image/upload/v1581392392/kjadclbvhq0gjnwvihnp.png\";\n                if (uid === res.data.sender._id) res.data.isMe = \"me\";\n                this.setState({ messageList: this.state.messageList.concat(res.data) });\n            });\n            this.socket.on(\"server-send-message-contain-image-from-chanel\", (res) => {\n                console.log(\"server-send-message-contain-image-from-chanel\", sid, res.data);\n                if (uid !== res.data.sender._id) {\n                    this.setState({ messageList: this.state.messageList.concat(res.data) });\n                }\n            });\n\n            this.socket.on(\"list-connected-chanel-users\", users => {\n                this.setState({ onlineUsers: users })\n            })\n\n        });\n    }\n\n    handleSendMessageFromChanel = () => {\n        try {\n            window.event.preventDefault();\n            let { chanelId } = this.props.match.params;\n            let textMessage = document.getElementById(\"text-message\");\n            if (textMessage.value.trim() || this.formData.get(\"photo\")) {\n                document.querySelector(\".preview-image #preview\").src = \"\";\n                document.querySelector(\".preview-image\").classList.remove(\"on\");\n\n                let uid = this.props.userPayload.user._id;\n                let name = this.props.userPayload.user.fullname || this.props.userPayload.user.email;\n                let photo = this.props.userPayload.user.photo;\n                let token = this.props.userPayload.token;\n\n                // emit event\n                let data = {};\n                data.sender = {};\n                data.chanelId = chanelId;\n                data.content = textMessage.value;\n                data.sender._id = uid;\n                data.sender.photo = photo;\n                data.sender.name = name;\n\n                this.socket.emit(\"client-send-message-from-chanel\", data, () => {\n                    textMessage.value = \"\";\n                    document.querySelector(\"#chat-area .content .container\").scrollBy(0, 2000);\n                })\n\n\n                if (chanelId !== \"anonymous\") {\n                    this.formData.append(\"cid\", chanelId);\n                    this.formData.append(\"uid\", uid);\n                    this.formData.append(\"content\", textMessage.value);\n                    postSaveChanelMessage(this.formData, token)\n                        .then(res => {\n                            console.log(res);\n                            this.formData.delete(\"photo\");\n                            if (res && res.urlContainImage) {\n                                let dataImage = {\n                                    sender: {\n                                        _id: uid,\n                                        name,\n                                        photo: photo\n                                    },\n                                    photo: res.urlContainImage,\n                                }\n                                this.setState({\n                                    messageList: this.state.messageList.concat(dataImage)\n                                });\n\n                                dataImage.chanelId = chanelId;\n                                this.socket.emit(\"client-send-message-contain-image-from-chanel\", dataImage, () => {\n                                    console.log(\"Server-send-message-contain-image-from-chanel\");\n                                })\n                            }\n                        })\n                        .catch(err => { console.log(err) })\n                } else {\n                    if (data.content.indexOf(\">p\") !== -1) {\n                        this.player = YouTubePlayer('video-player');\n                        this.handleSearchYoutuebe(data.content, this.player);\n                    }\n                }\n            }\n\n\n        } catch (e) { console.log(e) }\n    }\n\n    handleSearchYoutuebe = (q) => {\n        searchYoutube(q)\n            .then(res => {\n                console.log(this.player)\n                var vid = res.videoId;\n                if(vid) {\n                    this.onPlaying.push(vid);\n                }\n                this.player.loadVideoById(vid);\n                this.player.playVideo();\n\n                \n\n                this.player.on('stateChange', (event) => {\n                    console.log(\"stateChange\", event)\n                    if(event.data === 0) {\n                        console.log(\"end of video\", this.onPlaying)\n                        this.player.destroy();\n                        setTimeout( () => {\n                            this.player.loadVideoById(this.onPlaying.shift);\n                            this.player.playVideo();\n                        }, 0)\n                    }\n                });\n            })\n    }\n\n    handlePasteToInput = (event) => {\n        try {\n            let items = (event.clipboardData || event.originalEvent.clipboardData).items;\n            // find pasted image among pasted items\n            let blob = null;\n            for (let i = 0; i < items.length; i++) {\n                if (items[i].type.indexOf(\"image\") === 0) {\n                    blob = items[i].getAsFile();\n                }\n            }\n            // load image if there is a pasted image\n            if (blob !== null) {\n                let reader = new FileReader();\n                reader.onload = function (event) {\n                    document.querySelector('.preview-image').classList.add(\"on\");\n                    document.querySelector(\".preview-image #preview\").src = this.result;\n                };\n                reader.readAsDataURL(blob);\n                this.formData.append(\"photo\", blob);\n            }\n        } catch (e) { console.log(e) }\n    }\n\n    clearFormDataImage = () => {\n        document.querySelector('.preview-image').classList.remove(\"on\");\n        document.querySelector('.preview-image #preview').src = \"\";\n        this.formData.delete(\"photo\");\n    }\n\n    previewPhoto = (event) => {\n        let reader = new FileReader();\n        document.querySelector('.preview-image').classList.add(\"on\");\n        let inputAvatar = document.querySelector('.preview-image #preview');\n        reader.onload = function () {\n            inputAvatar.src = reader.result;\n        }\n        try {\n            reader.readAsDataURL(event.target.files[0]);\n            this.formData.append(\"photo\", event.target.files[0]);\n        } catch (e) {\n            // do nothing\n        }\n    }\n\n    checkUserEnter = (e) => {\n        if (e.keyCode === 13) {\n            this.handleSendMessageFromChanel();\n        }\n    }\n\n    toggleDropdown = () => {\n        try {\n            let drdElement = document.querySelector(\"#chat-area .list-more\");\n            if (drdElement.classList.length > 2) {\n                drdElement.classList.remove(\"active\");\n            } else {\n                drdElement.classList.add(\"active\");\n                document.getElementById(\"root\").addEventListener(\"click\", () => {\n                    drdElement.classList.remove(\"active\");\n                });\n            }\n        } catch (e) { }\n    }\n\n    render() {\n        let { messageList, onlineUsers, chanel } = this.state;\n        let uid = this.props.userPayload.user._id;\n\n        let tabActive = document.querySelectorAll(\".item-discussions.active\");\n        Array.from(tabActive).map(el => { el.classList.remove(\"active\") });\n        // active tab\n        let idTabElement = `dcs_${this.chanelId}`;\n        let tabElement = document.getElementById(idTabElement);\n        if (tabElement) {\n            tabElement.classList.add(\"active\")\n        }\n\n        return (\n            <Template tabPenel=\"-none\" widthRight=\"calc(100% - 80px)\">\n                <div id=\"video-player\">\n                    \n                </div>\n                <div id=\"chat-area\" className=\"chat-server\">\n                    <div className=\"top\">\n                        <div className=\"inside\">\n\n                            <div className=\"data\">\n                                <h5><a href=\"/chanels\">{chanel.chanelName}</a></h5>\n                            </div>\n                            <button className=\"btn d-md-block audio-call\" title=\"Audio call\">\n                                <i className=\"ti-headphone-alt\" />\n                            </button>\n                            <button className=\"btn d-md-block audio-call\" title=\"Audio call\">\n                                <i className=\"ti-video-camera\" />\n                            </button>\n                            <button className=\"btn d-md-block audio-call\" title=\"Audio call\">\n                                <i className=\"ti-info\" />\n                            </button>\n\n                            <div className=\"dropdown\" onClick={this.toggleDropdown}>\n                                <button className=\"btn d-md-block audio-call\" title=\"Audio call\">\n                                    <i className=\"ti-gird\" />\n                                </button>\n\n                                <div className=\"dropdown-list list-more\">\n                                    <a href=\"/\" className=\"voice\">Voice Call</a>\n                                    <a href=\"/\" className=\"voice\">Video Call</a>\n                                    <hr />\n                                    <a href=\"/\" className=\"voice\">Clear History</a>\n                                    <a href=\"/\" className=\"voice\">Block Contact</a>\n                                    <a href=\"/\" className=\"voice\">Delete Contact</a>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <aside >\n                        <div>\n                            <div className=\"content\">\n                                <div className=\"container\">\n                                    {\n                                        messageList.map((item, i) => {\n                                            if (i === this.LIMIT_MESSAGES - 1) {\n                                                return <>\n                                                    <div id=\"start-of-message\"></div>\n                                                    <ItemMessage\n                                                        key={i}\n                                                        isMe={item.sender._id === uid ? \"me\" : \"\"}\n                                                        content={item.content}\n                                                        contentPhoto={item.photo}\n                                                        photo={item.sender.photo}\n                                                        date={moment(item.created).fromNow() || \"just now\"}\n                                                        name={item.sender.fullname || item.sender.email}\n                                                        uid={item.sender._id}\n                                                    />\n                                                </>\n                                            }\n                                            return (\n                                                <ItemMessage\n                                                    key={i}\n                                                    isMe={item.sender._id === uid ? \"me\" : \"\"}\n                                                    content={item.content}\n                                                    contentPhoto={item.photo}\n                                                    photo={item.sender.photo}\n                                                    date={moment(item.created).fromNow() || \"just now\"}\n                                                    name={item.sender.fullname || item.sender.email}\n                                                    uid={item.sender._id}\n                                                />\n                                            )\n                                        })\n                                    }\n                                    <div id=\"end-of-message\"></div>\n                                </div>\n                                <div className=\"scroller\" />\n                            </div>\n                            <div className=\"bottom\">\n                                <form className=\"text-area\">\n                                    <textarea\n                                        id=\"text-message\" className=\"form-control\" placeholder=\"Start typing for reply...\" rows={1} defaultValue={\"\"}\n                                        onPaste={this.handlePasteToInput}\n                                    />\n                                    <div className=\"add-smiles\">\n                                        <span title=\"add icon\" className=\"em em-blush\" />\n                                    </div>\n                                    <button onClick={this.handleSendMessageFromChanel} style={{ height: '56x', outline: \"none\" }} type=\"submit\" className=\"btn send\"><i className=\"ti-location-arrow\" /></button>\n                                    <label className=\"label-input input-file\">\n                                        <input\n                                            type=\"file\" className=\"d-none\"\n                                            accept=\"image/*\"\n                                            onChange={this.previewPhoto}\n                                        />\n                                        <i className=\"ti-clip\" />\n                                    </label>\n                                </form>\n                            </div>\n                            <div onClick={this.clearFormDataImage} className=\"preview-image\">\n                                <img id=\"preview\" src=\"\" alt=\"\" />\n                            </div>\n                        </div>\n                        <div className=\"container tab-panel\">\n                            <div className=\"chanel user-online\">\n                                <header>Member online</header>\n                                {\n                                    onlineUsers.map((user, i) => {\n                                        return <a key={i} href=\"#list-chat\" className=\"item-discussions single\">\n                                            <img className=\"avatar-md\" src={user.photo} alt=\"avt\" />\n                                            <div className=\"data\">\n                                                <h5>{user.name}</h5>\n                                            </div>\n                                        </a>\n                                    })\n                                }\n                                <a href=\"#list-chat\" className=\"item-discussions single\">\n                                    <img className=\"avatar-md\" src=\"https://res.cloudinary.com/ddrw0yq95/image/upload/v1581392392/kjadclbvhq0gjnwvihnp.png\" alt=\"avt\" />\n                                    <div className=\"status offline\" />\n                                    <div className=\"data\">\n                                        <h5>Bob Frank</h5>\n\n                                    </div>\n                                </a>\n\n                            </div>\n                        </div>\n                    </aside>\n\n                </div>\n            </Template>\n        )\n    }\n}\n\nexport default ChatServerArea;"]},"metadata":{},"sourceType":"module"}